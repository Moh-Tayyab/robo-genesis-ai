# Data Model: Monorepo with Docusaurus Setup

**Feature**: 002-monorepo-docusaurus-setup
**Date**: 2025-11-29

## Overview

This feature primarily involves file structure and configuration rather than traditional data entities. The "data model" here describes the configuration files and their relationships.

## Configuration Entities

### 1. Root Package Manifest

**Entity**: `package.json` (root)
**Location**: `/package.json`
**Purpose**: Defines the monorepo workspace and root-level scripts

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| name | string | Yes | Package name: `robo-genesis-ai` |
| version | string | Yes | Semantic version: `0.1.0` |
| private | boolean | Yes | Must be `true` to prevent npm publish |
| scripts | object | Yes | Turborepo-delegated scripts |
| devDependencies | object | Yes | Root dev tools (turbo) |
| packageManager | string | Yes | pnpm version: `pnpm@10.18.3` |
| engines | object | Yes | Node.js/pnpm requirements |

**Validation Rules**:
- `private` MUST be `true`
- `engines.node` MUST be `>=20.0.0`
- `packageManager` MUST specify pnpm

### 2. Workspace Definition

**Entity**: `pnpm-workspace.yaml`
**Location**: `/pnpm-workspace.yaml`
**Purpose**: Defines which directories are pnpm workspaces

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| packages | string[] | Yes | Glob patterns for workspaces |

**Validation Rules**:
- MUST include `apps/*`
- MUST include `packages/*`
- MUST NOT include non-Node.js directories

### 3. Turborepo Configuration

**Entity**: `turbo.json`
**Location**: `/turbo.json`
**Purpose**: Defines task pipelines and caching behavior

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| $schema | string | No | JSON schema for IntelliSense |
| ui | string | No | Terminal UI mode |
| tasks | object | Yes | Task pipeline definitions |

**Task Schema**:
| Field | Type | Description |
|-------|------|-------------|
| dependsOn | string[] | Tasks that must run first |
| outputs | string[] | Cacheable output paths |
| cache | boolean | Whether to cache results |
| persistent | boolean | For long-running tasks (dev servers) |
| env | string[] | Environment variables for cache key |

**Validation Rules**:
- `build` task MUST have `outputs` defined
- `dev` task MUST have `cache: false` and `persistent: true`

### 4. Docusaurus App Manifest

**Entity**: `package.json` (apps/docs)
**Location**: `/apps/docs/package.json`
**Purpose**: Defines the Docusaurus application

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| name | string | Yes | Package name: `@robo-genesis-ai/docs` |
| version | string | Yes | App version |
| private | boolean | Yes | Must be `true` |
| scripts | object | Yes | Docusaurus commands |
| dependencies | object | Yes | Runtime dependencies |
| devDependencies | object | Yes | Dev dependencies |

**Required Dependencies**:
- `@docusaurus/core`: ^3.0.0
- `@docusaurus/preset-classic`: ^3.0.0
- `react`: ^18.2.0
- `react-dom`: ^18.2.0
- `@easyops-cn/docusaurus-search-local`: ^0.40.0

### 5. Docusaurus Configuration

**Entity**: `docusaurus.config.ts`
**Location**: `/apps/docs/docusaurus.config.ts`
**Purpose**: Main Docusaurus site configuration

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| title | string | Yes | Site title |
| tagline | string | No | Site tagline |
| url | string | Yes | Production URL |
| baseUrl | string | Yes | Base path (usually `/`) |
| i18n | object | Yes | Internationalization config |
| presets | array | Yes | Docusaurus presets |
| themeConfig | object | Yes | Theme configuration |
| themes | array | No | Additional themes (search) |

**Validation Rules**:
- `i18n.locales` MUST include `['en', 'ur']`
- `presets` MUST include `@docusaurus/preset-classic`
- `themes` SHOULD include search plugin

### 6. Sidebar Configuration

**Entity**: `sidebars.ts`
**Location**: `/apps/docs/sidebars.ts`
**Purpose**: Navigation sidebar structure

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| mainSidebar | array | Yes | Sidebar items |

**Sidebar Item Types**:
- `doc`: Single document reference
- `category`: Group of documents with label
- `link`: External link
- `autogenerated`: Auto-generated from folder

## Relationships

```
package.json (root)
    ├── references → turbo.json (via scripts)
    ├── references → pnpm-workspace.yaml (workspace definition)
    └── manages → devDependencies (turbo)

pnpm-workspace.yaml
    └── includes → apps/docs/package.json

turbo.json
    └── orchestrates → apps/docs (build, dev, lint tasks)

apps/docs/package.json
    ├── configures → docusaurus.config.ts
    └── configures → sidebars.ts

docusaurus.config.ts
    ├── references → sidebars.ts
    └── configures → search plugin
```

## State Transitions

### Monorepo Initialization State

```
UNINITIALIZED → INITIALIZED → READY

UNINITIALIZED:
  - No package.json
  - No turbo.json
  - No pnpm-workspace.yaml

INITIALIZED:
  - package.json exists
  - turbo.json exists
  - pnpm-workspace.yaml exists
  - apps/ and packages/ directories exist (empty)
  - `pnpm install` succeeds

READY:
  - All of INITIALIZED
  - `turbo run build` succeeds (no errors)
```

### Docusaurus App State

```
NOT_CREATED → CREATED → CONFIGURED → RUNNING

NOT_CREATED:
  - apps/docs/ does not exist

CREATED:
  - apps/docs/ exists
  - package.json exists
  - Basic Docusaurus files present

CONFIGURED:
  - docusaurus.config.ts customized
  - sidebars.ts configured
  - Search plugin installed
  - i18n configured

RUNNING:
  - `pnpm dev` starts server successfully
  - Site accessible at localhost:3000
  - Search functional
  - Sidebar navigation works
```
